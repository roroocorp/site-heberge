<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daily Productivity</title>
<style>
  body { margin:0; font-family: Arial, sans-serif; transition: background 0.3s; }
  header { display:flex; justify-content: space-between; align-items: center; padding:10px; background:#f88; color:white; }
  header h1 { margin:0; font-size:1.2em; }
  .menu-bars { font-size:1.5em; cursor:pointer; }
  main { padding:10px; display:flex; flex-direction:column; gap:15px; }
  .section { padding:15px; background: rgba(255,255,255,0.3); border-radius:10px; }
  select, input, button { margin:5px 0; padding:5px; font-size:1em; }
  #chat-box { height:200px; overflow-y:auto; background:#fff; padding:5px; border-radius:5px; margin-bottom:5px; }
  .chat-message { margin:5px 0; }
  #side-menu { display:none; position:fixed; top:0; left:0; width:250px; height:100%; background:#eee; padding:10px; overflow-y:auto; box-shadow:2px 0 5px rgba(0,0,0,0.3); z-index:100; }
  #side-menu h2 { margin-top:0; }
  #side-menu button { display:block; margin:5px 0; width:100%; }
</style>
</head>
<body>

<header>
  <span id="header-text">Daily Productivity</span>
  <span class="menu-bars" id="menu-bars">&#9776;</span>
</header>

<div id="side-menu">
  <h2>Menu</h2>
  <button id="home-btn">Accueil</button>
  <button id="new-convo-btn">Nouvelle conversation</button>
  <div id="conversations-list"></div>
</div>

<main id="main-content">

<div class="section">
  üé® <strong>Th√®me</strong><br>
  <select id="theme-select">
    <option value="pink">Rose</option>
    <option value="red">Rouge</option>
    <option value="green">Vert</option>
    <option value="blue">Bleu</option>
  </select>
</div>

<div class="section">
  üåç <strong>Langue</strong><br>
  <select id="lang-select">
    <option value="fr">Fran√ßais</option>
    <option value="en">Anglais</option>
    <option value="de">Allemand</option>
  </select>
</div>

<div class="section">
  ‚úÖ <strong>To-Do</strong><br>
  <input type="text" id="task-input" placeholder="Nouvelle t√¢che">
  <button id="add-task">Ajouter</button>
  <ul id="task-list"></ul>
</div>

<div class="section">
  üë®‚Äçüç≥ <strong>Id√©es de repas</strong><br>
  <button id="generate-meal">G√©n√©rer un repas</button>
  <div id="meal-suggestion"></div>
</div>

<div class="section" id="chat-section">
  ü§ñ <strong>Chat IA</strong><br>
  <div id="chat-box"></div>
  <input type="text" id="chat-input" placeholder="√âcris un message...">
  <button id="send-chat">Envoyer</button>
</div>

</main>

<script>
  // --- Side Menu ---
  const menuBars = document.getElementById('menu-bars');
  const sideMenu = document.getElementById('side-menu');
  menuBars.addEventListener('click', ()=>{ sideMenu.style.display = sideMenu.style.display==='block' ? 'none' : 'block'; });

  // --- Conversations ---
  const conversationsList = document.getElementById('conversations-list');
  let conversations = JSON.parse(localStorage.getItem('conversations') || '[]');
  function renderConversations(){
    conversationsList.innerHTML = '';
    conversations.forEach((c,i)=>{
      const btn = document.createElement('button');
      btn.textContent = c.name;
      btn.onclick = ()=>openConversation(i);
      conversationsList.appendChild(btn);
    });
  }
  function openConversation(index){
    currentConvo = index;
    chatBox.innerHTML = '';
    conversations[index].messages.forEach(msg=>{
      appendMessage(msg.role+': '+msg.content);
    });
    sideMenu.style.display='none';
  }
  let currentConvo = -1;
  function addNewConversation(){
    const name = 'Conversation ' + (conversations.length +1);
    const convo = { name, messages:[] };
    conversations.push(convo);
    localStorage.setItem('conversations', JSON.stringify(conversations));
    renderConversations();
    openConversation(conversations.length-1);
  }
  document.getElementById('new-convo-btn').addEventListener('click', addNewConversation);
  document.getElementById('home-btn').addEventListener('click', ()=>{ sideMenu.style.display='none'; });
  renderConversations();

  // --- Th√®me ---
  const themeSelect = document.getElementById('theme-select');
  themeSelect.value = localStorage.getItem('theme') || 'pink';
  function applyTheme(value) {
    localStorage.setItem('theme', value);
    switch(value){
      case 'pink': document.body.style.background = 'linear-gradient(to bottom, #fdd, #faa)'; break;
      case 'red': document.body.style.background = 'linear-gradient(to bottom, #faa, #f66)'; break;
      case 'green': document.body.style.background = 'linear-gradient(to bottom, #dfd, #6f6)'; break;
      case 'blue': document.body.style.background = 'linear-gradient(to bottom, #ddf, #66f)'; break;
    }
  }
  applyTheme(themeSelect.value);
  themeSelect.addEventListener('change', e => applyTheme(e.target.value));

  // --- Langue ---
  const langSelect = document.getElementById('lang-select');
  langSelect.value = localStorage.getItem('lang') || 'fr';
  langSelect.addEventListener('change', e => { localStorage.setItem('lang', e.target.value); });

  // --- To-Do ---
  const taskInput = document.getElementById('task-input');
  const taskList = document.getElementById('task-list');
  const addTask = document.getElementById('add-task');
  let tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
  function renderTasks(){
    taskList.innerHTML = '';
    tasks.forEach((t,i)=>{
      const li = document.createElement('li');
      li.textContent = t;
      const del = document.createElement('button');
      del.textContent = 'X';
      del.onclick = ()=>{ tasks.splice(i,1); saveTasks(); renderTasks(); };
      li.appendChild(del);
      taskList.appendChild(li);
    });
  }
  function saveTasks(){ localStorage.setItem('tasks', JSON.stringify(tasks)); }
  addTask.onclick = ()=>{ if(taskInput.value.trim()){ tasks.push(taskInput.value.trim()); saveTasks(); renderTasks(); taskInput.value=''; } }
  renderTasks();

  // --- Id√©es de repas ---
  const meals = ['Pizza','P√¢tes','Salade','Sushi','Burger','Riz saut√©','Curry'];
  document.getElementById('generate-meal').onclick = ()=> {
    const meal = meals[Math.floor(Math.random()*meals.length)];
    document.getElementById('meal-suggestion').textContent = meal;
  };

  // --- Chat IA ---
  const chatBox = document.getElementById('chat-box');
  const chatInput = document.getElementById('chat-input');
  const sendChat = document.getElementById('send-chat');

  async function sendMessage() {
    const text = chatInput.value.trim();
    if(!text) return;
    appendMessage('Vous: ' + text);
    if(currentConvo>=0) conversations[currentConvo].messages.push({role:'Vous',content:text});
    chatInput.value = '';

    try {
      const response = await fetch('https://api.openai.com/v1/chat/completions',{
        method:'POST',
        headers:{ 'Content-Type':'application/json', 'Authorization':'Bearer VOTRE_CLE_API' },
        body: JSON.stringify({
          model: "gpt-3.5-turbo",
          messages: [{ role: "user", content: text }]
        })
      });
      const data = await response.json();
      const botMessage = data.choices[0].message.content;
      appendMessage('IA: ' + botMessage);
      if(currentConvo>=0) { conversations[currentConvo].messages.push({role:'IA',content:botMessage}); localStorage.setItem('conversations', JSON.stringify(conversations)); }
    } catch(e) {
      appendMessage('Erreur IA: ' + e.message);
    }
  }

  function appendMessage(msg){
    const div = document.createElement('div');
    div.className = 'chat-message';
    div.textContent = msg;
    chatBox.appendChild(div);
    chatBox.scrollTop = chatBox.scrollHeight;
  }

  sendChat.onclick = sendMessage;
  chatInput.addEventListener('keypress', e => { if(e.key==='Enter') sendMessage(); });

</script>
</body>
    </html>

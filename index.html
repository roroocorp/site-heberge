<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Daily Life IA Ultra</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui}
html,body{width:100%;overflow-x:hidden}
body{min-height:100vh;color:#fff;padding:10px;transition:0.3s}
.container{max-width:420px;margin:auto}

/* THEMES */
body.green{background:linear-gradient(180deg,#064e3b,#042f2e)}
body.red{background:linear-gradient(180deg,#7f1d1d,#450a0a)}
body.blue{background:linear-gradient(180deg,#1e3a8a,#020617)}
body.rose{background:linear-gradient(180deg,#9d174d,#4a044e)}
body.violet{background:linear-gradient(180deg,#5b21b6,#2e1065)}

header{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px;padding-top:6px}
header h1{font-size:20px}
.menu-btn{font-size:24px;cursor:pointer}

.card{background:rgba(255,255,255,.12);backdrop-filter:blur(14px);border-radius:18px;padding:14px;margin-bottom:12px}
input,select,button{width:100%;padding:10px;border:none;border-radius:12px;margin-top:6px}
input,select{background:rgba(255,255,255,.9)}
button{background:rgba(255,255,255,.2);color:#fff;font-weight:bold;cursor:pointer}
ul{list-style:none;margin-top:6px}
li{background:rgba(255,255,255,.15);padding:8px;border-radius:10px;margin-top:6px;user-select:none}
li.done{text-decoration:line-through;opacity:.6}

/* SIDEBAR */
#sidebar{position:fixed;top:0;left:-100%;width:75%;max-width:280px;height:100%;background:#0f172a;padding:15px;transition:.3s;z-index:10}
#sidebar.active{left:0}
#sidebar h3{margin-bottom:10px}
.item{display:flex;justify-content:space-between;align-items:center;padding:8px;border-bottom:1px solid #334;cursor:pointer}
.del{opacity:.6;font-size:14px}

/* CHAT */
#chat{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:#020617;z-index:9;flex-direction:column}
#messages{flex:1;overflow-y:auto;padding:10px}
.msg{margin-bottom:6px}
.user{color:#38bdf8}
.ai{color:#a7f3d0}

/* CHAT INPUT */
#chatInputContainer{display:flex;gap:6px;padding:6px;background:rgba(0,0,0,0.1);border-radius:12px;}
#chatInput{flex:1;padding:10px;border-radius:12px;border:none;}
#chatSend{padding:10px;border-radius:12px;background:#38bdf8;color:#fff;font-weight:bold;cursor:pointer;}
</style>
</head>
<body class="green">

<!-- SIDEBAR -->
<div id="sidebar">
<h3>ğŸ“œ Historique</h3>
<div class="item" onclick="newConversation()">â• Nouvelle conversation</div>
<div id="convList"></div>
<div class="item" onclick="goHome()">ğŸ  Accueil</div>
</div>

<!-- CHAT -->
<div id="chat">
<header>
<h1 id="chatTitle">Conversation</h1>
<span class="menu-btn" onclick="toggleMenu()">â˜°</span>
</header>
<div id="messages"></div>
<div id="chatInputContainer">
<input id="chatInput" placeholder="Ã‰cris un message..." onkeydown="if(event.key==='Enter'){sendMsg();event.preventDefault()}">
<button id="chatSend" onclick="sendMsg()">Envoyer</button>
</div>
</div>

<!-- MAIN -->
<div class="container" id="main">
<header>
<h1>Daily Life Ultra IA</h1>
<span class="menu-btn" onclick="toggleMenu()">â˜°</span>
</header>

<div class="card">
<h3>ğŸŒ Langue</h3>
<select onchange="changeLang(this.value)">
<option value="fr">FranÃ§ais</option>
<option value="en">English</option>
<option value="es">EspaÃ±ol</option>
<option value="de">Deutsch</option>
</select>
</div>

<div class="card">
<h3>ğŸ¨ ThÃ¨me</h3>
<select onchange="changeTheme(this.value)">
<option value="green">Vert</option>
<option value="red">Rouge</option>
<option value="blue">Bleu</option>
<option value="rose">Rose</option>
<option value="violet">Violet</option>
</select>
</div>

<div class="card">
<h3>ğŸ“Š Stats</h3>
<p>Points : <span id="points">0</span></p>
<p>Niveau : <span id="level">1</span></p>
</div>

<div class="card">
<h3>âœ… TÃ¢ches</h3>
<input id="taskInput" placeholder="Nouvelle tÃ¢che">
<button onclick="addTask()">Ajouter</button>
<ul id="tasks"></ul>
</div>

<div class="card">
<h3>ğŸ§‘â€ğŸ³ Menu semaine</h3>
<button onclick="generateMenu()">GÃ©nÃ©rer</button>
<ul id="menu"></ul>
</div>

<div class="card">
<h3>ğŸ›’ Liste de courses</h3>
<button onclick="generateCourses()">Depuis menu</button>
<ul id="courses"></ul>
</div>

<div class="card">
<h3>â° Rappel</h3>
<input type="time" id="alarm">
<button onclick="setAlarm()">Activer</button>
</div>
</div>

<script>
/* ===== GLOBAL ===== */
let lang=localStorage.lang||"fr"
let conversations=JSON.parse(localStorage.conversations||"[]")
let currentConv=null
let tasks=JSON.parse(localStorage.tasks||"[]")
let points=Number(localStorage.points||0)
let menu=JSON.parse(localStorage.menu||"[]")
let courses=JSON.parse(localStorage.courses||"[]")
const meals=[
"Spaghetti Bolognese","Poulet Curry","Salade CÃ©sar","Pizza Margherita","Tacos","Riz sautÃ©","Soupe lÃ©gumes","Burger","Poisson grillÃ©","Paella","Quiche","Ratatouille",
"Pad ThaÃ¯","Sushi","Chili con Carne","Falafel","Couscous","PÃ¢tes au pesto","Lasagne","Boeuf Stroganoff","Moussaka","Gyoza"
]

/* ===== SAVE ===== */
function saveAll(){
localStorage.conversations=JSON.stringify(conversations)
localStorage.tasks=JSON.stringify(tasks)
localStorage.points=points
localStorage.lang=lang
localStorage.menu=JSON.stringify(menu)
localStorage.courses=JSON.stringify(courses)
renderAll()
}

/* ===== RENDER ===== */
function renderAll(){
document.getElementById("points").textContent=points
document.getElementById("level").textContent=Math.floor(points/50)+1
renderTasks()
renderConvList()
renderMenu()
renderCourses()
}

/* ===== MENU SIDEBAR ===== */
function toggleMenu(){sidebar.classList.toggle("active")}
function goHome(){chat.style.display="none";main.style.display="block";sidebar.classList.remove("active")}

/* ===== CONVERSATIONS ===== */
function newConversation(){
  const id = Date.now();
  conversations.unshift({id, title:`Conversation ${conversations.length+1}`, msgs:[]});
  currentConv = id;
  saveAll();
  openChat(); // Affiche le chat immÃ©diatement
}

function renderConvList(){
convList.innerHTML=""
conversations.forEach((c,i)=>{
c.title=`Conversation ${conversations.length-i}`
let d=document.createElement("div")
d.className="item"
d.innerHTML=`<span>${c.title}</span><span class="del">ğŸ—‘ï¸</span>`
d.onclick=(e)=>{
if(e.target.classList.contains("del")){
conversations=conversations.filter(x=>x.id!==c.id)
if(currentConv===c.id) goHome()
saveAll()
}else{currentConv=c.id;openChat()}
}
convList.appendChild(d)
})
}

function openChat(){
if(currentConv===null) return;
const c = conversations.find(x => x.id === currentConv);
if(!c) return;
chat.style.display="flex";
main.style.display="none";
sidebar.classList.remove("active");
renderMessages();
chatInput.focus(); // Active le champ texte
}

/* ===== CHAT ===== */
function renderMessages(){
messages.innerHTML=""
const c=conversations.find(x=>x.id===currentConv)
if(!c)return
chatTitle.textContent=c.title
c.msgs.forEach(m=>{
messages.innerHTML+=`<div class="msg ${m.w}">${m.w==="user"?"ğŸ‘¤":"ğŸ¤–"} ${m.t}</div>`
})
messages.scrollTop=messages.scrollHeight
}

function sendMsg(){
const t=chatInput.value.trim()
if(!t||currentConv===null)return
const c=conversations.find(x=>x.id===currentConv)
c.msgs.push({w:"user",t})
chatInput.value=""
setTimeout(()=>{
c.msgs.push({w:"ai",t:smartAI(t)})
saveAll()
renderMessages()
},300)
saveAll()
}

/* ===== IA FAUSSE INTELLIGENTE ===== */
function smartAI(text){
text=text.toLowerCase()
if(text.includes("recette")||text.includes("menu")){
return meals[Math.floor(Math.random()*meals.length)]
}
if(text.includes("aide")){
switch(lang){
case "en": return "I can help organize your day."
case "es": return "Puedo ayudarte a organizar tu dÃ­a."
case "de": return "Ich kann dir helfen, deinen Tag zu organisieren."
default: return "Je peux tâ€™aider Ã  organiser ta journÃ©e."
}
}
if(text.includes("bonjour")||text.includes("salut")) {
switch(lang){
case "en": return "Hello!"
case "es": return "Â¡Hola!"
case "de": return "Hallo!"
default: return "Salut !"
}
}
switch(lang){
case "en": return "I am here to assist you."
case "es": return "Estoy aquÃ­ para ayudarte."
case "de": return "Ich bin hier, um dir zu helfen."
default: return "Je suis lÃ  pour tâ€™aider."
}
}

/* ===== TASKS ===== */
function addTask(){
if(taskInput.value){tasks.push({t:taskInput.value,d:false});taskInput.value="";points+=5;saveAll()}
}
function renderTasks(){
tasksEl.innerHTML=""
tasks.forEach((t)=>{
let li=document.createElement("li")
li.textContent=t.t
if(t.d)li.classList.add("done")
li.onclick=()=>{t.d=!t.d;points+=5;saveAll()}
tasksEl.appendChild(li)
})
}

/* ===== MENU & COURSES ===== */
function generateMenu(){menu=[];for(let i=0;i<7;i++)menu.push(meals[Math.floor(Math.random()*meals.length)]);saveAll()}
function renderMenu(){menuEl.innerHTML="";menu.forEach(m=>menuEl.innerHTML+=`<li>${m}</li>`)}
function generateCourses(){courses=[...new Set(menu)];saveAll()}
function renderCourses(){coursesEl.innerHTML="";courses.forEach((c,i)=>{let li=document.createElement("li");li.textContent=c;let timer;li.addEventListener("touchstart",()=>timer=setTimeout(()=>{courses.splice(i,1);saveAll()},600));li.addEventListener("touchend",()=>clearTimeout(timer));coursesEl.appendChild(li)})}

/* ===== THEME & LANG ===== */
function changeTheme(t){document.body.className=t}
function changeLang(l){lang=l;saveAll()}

/* ===== ALARM ===== */
function setAlarm(){
Notification.requestPermission()
const time=alarm.value
setInterval(()=>{
const now=new Date().toTimeString().slice(0,5)
if(now===time) new Notification("â° Rappel !")
},30000)
}

/* ===== RENDER INIT ===== */
renderAll()
</script>
</body>
  </html>
